/* eslint-disable prefer-template */
/* eslint-disable prettier/prettier */
/* eslint-disable @typescript-eslint/no-empty-function */
/* eslint-disable max-len */
/* eslint-disable @typescript-eslint/no-inferrable-types */
/* eslint-disable no-magic-numbers */
import { test, expect } from '@fixtures';
import { Page } from '@playwright/test';
import { Base } from '@tests/pages/constants/monomers/Bases';
import { Chem } from '@tests/pages/constants/monomers/Chem';
import { Nucleotide } from '@tests/pages/constants/monomers/Nucleotides';
import { Peptide } from '@tests/pages/constants/monomers/Peptides';
import { Phosphate } from '@tests/pages/constants/monomers/Phosphates';
import { Preset } from '@tests/pages/constants/monomers/Presets';
import { Sugar } from '@tests/pages/constants/monomers/Sugars';
import { Library } from '@tests/pages/macromolecules/Library';

let page: Page;

test.beforeAll(async ({ initFlexCanvas }) => {
  page = await initFlexCanvas();
});

test.afterEach(async () => {});

test.afterAll(async ({ closePage }) => {
  await closePage();
});

async function updateMonomersLibrary(
  page: Page,
  sdfString: string,
): Promise<string | null> {
  return page.evaluate(async (cmd) => {
    try {
      await window.ketcher.updateMonomersLibrary(cmd);
      return null;
    } catch (error) {
      if (error instanceof Error) {
        return error.message;
      }

      return String(error);
    }
  }, sdfString);
}

test('Case 1: Verify library update functionality: Base', async () => {
  /*
   * Test case: https://github.com/epam/ketcher/issues/8345
   * Description: Upload _Base1 base to the library
   * Scenario:
   * 1. Go to Macro mode
   * 2. Execute command in console to add _Base1 to the library
   * 3. Check that the structure appears in the Library
   *
   * Version 3.9
   */
  const sdfFile =
    '\n  -INDIGO-10092512402D\n\n  0  0  0  0  0  0  0  0  0  0  0 V3000\nM  V30 BEGIN CTAB\nM  V30 COUNTS 1 0 0 0 0\nM  V30 BEGIN ATOM\nM  V30 1 _Base1 10.9051 -9.2 0.0 0 CLASS=BASE\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 END BOND\nM  V30 END CTAB\nM  V30 BEGIN TEMPLATE\nM  V30 TEMPLATE 1 BASE/_Base1/_Base1 NATREPLACE=BASE/A\nM  V30 BEGIN CTAB\nM  V30 COUNTS 13 12 5 0 0\nM  V30 BEGIN ATOM\nM  V30 1 H -4.33 0.75 0.0 0\nM  V30 2 P -3.464 0.25 0.0 0\nM  V30 3 C -2.598 0.75 0.0 0\nM  V30 4 C -1.732 0.25 0.0 0\nM  V30 5 C -0.866 0.75 0.0 0\nM  V30 6 C 0.0 0.25 0.0 0\nM  V30 7 C 0.866 0.75 0.0 0\nM  V30 8 C 1.732 0.25 0.0 0\nM  V30 9 C 2.598 0.75 0.0 0\nM  V30 10 C 3.464 0.25 0.0 0\nM  V30 11 H 4.33 0.75 0.0 0\nM  V30 12 H -3.464 -0.75 0.0 0\nM  V30 13 H -1.732 -0.75 0.0 0\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 1 1 1 2\nM  V30 2 1 2 3\nM  V30 3 1 3 4\nM  V30 4 1 4 5\nM  V30 5 1 5 6\nM  V30 6 1 6 7\nM  V30 7 1 7 8\nM  V30 8 1 8 9\nM  V30 9 1 9 10\nM  V30 10 1 10 11\nM  V30 11 1 2 12\nM  V30 12 1 4 13\nM  V30 END BOND\nM  V30 BEGIN SGROUP\nM  V30 1 SUP 1 ATOMS=(1 1) XBONDS=(1 1) BRKXYZ=(9 0.433000 -0.250000 0.000000-\nM  V30  0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS=-\nM  V30 LGRP\nM  V30 2 SUP 2 ATOMS=(1 11) XBONDS=(1 10) BRKXYZ=(9 -0.433000 -0.250000 0.000-\nM  V30 000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLA-\nM  V30 SS=LGRP\nM  V30 3 SUP 3 ATOMS=(1 12) XBONDS=(1 11) BRKXYZ=(9 0.000000 0.500000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 4 SUP 4 ATOMS=(1 13) XBONDS=(1 12) BRKXYZ=(9 0.000000 0.500000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 5 SUP 5 ATOMS=(9 2 3 4 5 6 7 8 9 10) XBONDS=(4 1 11 12 10) BRKXYZ=(9 --\nM  V30 0.433000 0.250000 0.000000 0.000000 -0.500000 0.000000 0.000000 0.0000-\nM  V30 00 0.000000) BRKXYZ=(9 0.000000 -0.500000 0.000000 0.433000 0.250000 0-\nM  V30 .000000 0.000000 0.000000 0.000000) LABEL=_Base1 CLASS=BASE SAP=(3 2 1-\nM  V30  Al) SAP=(3 10 11 Br) SAP=(3 2 12 Cx) SAP=(3 4 13 Dx) NATREPLACE=BASE/A\nM  V30 END SGROUP\nM  V30 END CTAB\nM  V30 END TEMPLATE\nM  END\n>  <type>\nmonomerTemplate\n\n>  <aliasHELM>\n_Base1_HELM\n\n$$$$\n';
  const error = await updateMonomersLibrary(page, sdfFile);
  expect(error).toBeNull();
  expect(await Library(page).isMonomerExist(Base._Base1)).toBeTruthy();
});

test('Case 2: Verify library update functionality: CHEM', async () => {
  /*
   * Test case: https://github.com/epam/ketcher/issues/8345
   * Description: Upload _CHEM1 chem to the library
   * Scenario:
   * 1. Go to Macro mode
   * 2. Execute command in console to add _CHEM1 to the library
   * 3. Check that the structure appears in the Library
   *
   * Version 3.9
   */
  const sdfFile =
    '\n  -INDIGO-10092513342D\n\n  0  0  0  0  0  0  0  0  0  0  0 V3000\nM  V30 BEGIN CTAB\nM  V30 COUNTS 1 0 0 0 0\nM  V30 BEGIN ATOM\nM  V30 1 _CHEM1 10.1551 -9.35993 0.0 0 CLASS=LINKER\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 END BOND\nM  V30 END CTAB\nM  V30 BEGIN TEMPLATE\nM  V30 TEMPLATE 1 LINKER/_CHEM1/_CHEM1\nM  V30 BEGIN CTAB\nM  V30 COUNTS 17 16 5 0 0\nM  V30 BEGIN ATOM\nM  V30 1 H -4.33 0.31 0.0 0\nM  V30 2 C -3.464 -0.19 0.0 0\nM  V30 3 P -2.598 0.31 0.0 0\nM  V30 4 P -1.732 -0.19 0.0 0\nM  V30 5 C -0.866 0.31 0.0 0\nM  V30 6 C 0.0 -0.19 0.0 0\nM  V30 7 C 0.866 0.31 0.0 0\nM  V30 8 C 1.732 -0.19 0.0 0\nM  V30 9 C 2.598 0.31 0.0 0\nM  V30 10 C 3.464 -0.19 0.0 0\nM  V30 11 H 4.33 0.31 0.0 0\nM  V30 12 C 1.573 1.017 0.0 0\nM  V30 13 C 1.314 1.983 0.0 0\nM  V30 14 H 2.021 2.69 0.0 0\nM  V30 15 C -1.732 -1.19 0.0 0\nM  V30 16 C -0.866 -1.69 0.0 0\nM  V30 17 H -0.866 -2.69 0.0 0\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 1 1 1 2\nM  V30 2 1 2 3\nM  V30 3 1 3 4\nM  V30 4 1 4 5\nM  V30 5 1 5 6\nM  V30 6 1 6 7\nM  V30 7 1 7 8\nM  V30 8 1 8 9\nM  V30 9 1 9 10\nM  V30 10 1 10 11\nM  V30 11 1 7 12\nM  V30 12 1 12 13\nM  V30 13 1 13 14\nM  V30 14 1 4 15\nM  V30 15 1 15 16\nM  V30 16 1 16 17\nM  V30 END BOND\nM  V30 BEGIN SGROUP\nM  V30 1 SUP 1 ATOMS=(1 1) XBONDS=(1 1) BRKXYZ=(9 0.433000 -0.250000 0.000000-\nM  V30  0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS=-\nM  V30 LGRP\nM  V30 2 SUP 2 ATOMS=(1 11) XBONDS=(1 10) BRKXYZ=(9 -0.433000 -0.250000 0.000-\nM  V30 000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLA-\nM  V30 SS=LGRP\nM  V30 3 SUP 3 ATOMS=(1 14) XBONDS=(1 13) BRKXYZ=(9 -0.353500 -0.353500 0.000-\nM  V30 000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLA-\nM  V30 SS=LGRP\nM  V30 4 SUP 4 ATOMS=(1 17) XBONDS=(1 16) BRKXYZ=(9 0.000000 0.500000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 5 SUP 5 ATOMS=(13 2 3 4 5 6 7 8 9 10 12 13 15 16) XBONDS=(4 1 10 13 16-\nM  V30 ) BRKXYZ=(9 -0.433000 0.250000 0.000000 0.433000 0.250000 0.000000 0.0-\nM  V30 00000 0.000000 0.000000) BRKXYZ=(9 0.353500 0.353500 0.000000 0.000000-\nM  V30  -0.500000 0.000000 0.000000 0.000000 0.000000) LABEL=_CHEM1 CLASS=LIN-\nM  V30 KER SAP=(3 2 1 Al) SAP=(3 10 11 Br) SAP=(3 13 14 Cx) SAP=(3 16 17 Dx)\nM  V30 END SGROUP\nM  V30 END CTAB\nM  V30 END TEMPLATE\nM  END\n>  <type>\nmonomerTemplate\n\n>  <idtAliases>\nbase=_CHEM1\n\n$$$$\n';
  const error = await updateMonomersLibrary(page, sdfFile);
  expect(error).toBeNull();
  expect(await Library(page).isMonomerExist(Chem._CHEM1)).toBeTruthy();
});

test('Case 3: Verify library update functionality: Nucleotide', async () => {
  /*
   * Test case: https://github.com/epam/ketcher/issues/8345
   * Description: Upload _Nucleotide1 nucleotide to the library
   * Scenario:
   * 1. Go to Macro mode
   * 2. Execute command in console to add _Nucleotide1 to the library
   * 3. Check that the structure appears in the Library
   *
   * Version 3.9
   */
  const sdfFile =
    '\n  -INDIGO-10122513312D\n\n  0  0  0  0  0  0  0  0  0  0  0 V3000\nM  V30 BEGIN CTAB\nM  V30 COUNTS 1 0 0 0 0\nM  V30 BEGIN ATOM\nM  V30 1 _Nucleotide1 9.9 -9.35 0.0 0 CLASS=RNA SEQID=1\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 END BOND\nM  V30 END CTAB\nM  V30 BEGIN TEMPLATE\nM  V30 TEMPLATE 1 RNA/_Nucleotide1/_Nucleotide1 NATREPLACE=RNA/A\nM  V30 BEGIN CTAB\nM  V30 COUNTS 5 4 4 0 0\nM  V30 BEGIN ATOM\nM  V30 1 C -0.866 -0.75 0.0 0\nM  V30 2 C 0.0 -0.25 0.0 0\nM  V30 3 H 0.0 0.75 0.0 0\nM  V30 4 H 0.866 -0.75 0.0 0\nM  V30 5 H 0.866 0.25 0.0 0\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 1 1 1 2\nM  V30 2 1 2 3\nM  V30 3 1 2 4\nM  V30 4 1 2 5\nM  V30 END BOND\nM  V30 BEGIN SGROUP\nM  V30 1 SUP 1 ATOMS=(1 3) XBONDS=(1 2) BRKXYZ=(9 0.000000 -0.500000 0.000000-\nM  V30  0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS=-\nM  V30 LGRP\nM  V30 2 SUP 2 ATOMS=(1 5) XBONDS=(1 4) BRKXYZ=(9 -0.433000 -0.250000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 3 SUP 3 ATOMS=(1 4) XBONDS=(1 3) BRKXYZ=(9 -0.433000 0.250000 0.000000-\nM  V30  0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS=-\nM  V30 LGRP\nM  V30 4 SUP 4 ATOMS=(2 1 2) XBONDS=(3 2 3 4) BRKXYZ=(9 0.000000 0.500000 0.0-\nM  V30 00000 0.433000 -0.250000 0.000000 0.000000 0.000000 0.000000) BRKXYZ=(-\nM  V30 9 0.433000 0.250000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000-\nM  V30 000 0.000000) LABEL=_Nucleotide1 CLASS=RNA SAP=(3 2 3 Al) SAP=(3 2 5 B-\nM  V30 r) SAP=(3 2 4 Cx) NATREPLACE=RNA/A\nM  V30 END SGROUP\nM  V30 END CTAB\nM  V30 END TEMPLATE\nM  END\n>  <type>\nmonomerTemplate\n\n>  <idtAliases>\nbase=_Nucleotide1,ep3=/N1_ep3/,ep5=/N1_ep5/,internal=/N1_i/\n\n$$$$\n';
  const error = await updateMonomersLibrary(page, sdfFile);
  expect(error).toBeNull();
  expect(
    await Library(page).isMonomerExist(Nucleotide._Nucleotide1),
  ).toBeTruthy();
});

test('Case 4: Verify library update functionality: Peptide', async () => {
  /*
   * Test case: https://github.com/epam/ketcher/issues/8345
   * Description: Upload _Peptide1 peptide to the library
   * Scenario:
   * 1. Go to Macro mode
   * 2. Execute command in console to add _Peptide1 to the library
   * 3. Check that the structure appears in the Library
   *
   * Version 3.9
   */
  const sdfFile =
    '\n  -INDIGO-10122515372D\n\n  0  0  0  0  0  0  0  0  0  0  0 V3000\nM  V30 BEGIN CTAB\nM  V30 COUNTS 1 0 0 0 0\nM  V30 BEGIN ATOM\nM  V30 1 _Peptide1 11.975 -7.85 0.0 0 CLASS=AA SEQID=1\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 END BOND\nM  V30 END CTAB\nM  V30 BEGIN TEMPLATE\nM  V30 TEMPLATE 1 AA/_Peptide1/_Peptide1/ NATREPLACE=AA/A\nM  V30 BEGIN CTAB\nM  V30 COUNTS 4 3 3 0 0\nM  V30 BEGIN ATOM\nM  V30 1 C -0.75 0.0 0.0 0\nM  V30 2 C 0.25 0.0 0.0 0\nM  V30 3 H 0.75 0.866 0.0 0\nM  V30 4 H 0.75 -0.866 0.0 0\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 1 2 1 2\nM  V30 2 1 2 3\nM  V30 3 1 2 4\nM  V30 END BOND\nM  V30 BEGIN SGROUP\nM  V30 1 SUP 1 ATOMS=(1 3) XBONDS=(1 2) BRKXYZ=(9 -0.250000 -0.433000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 2 SUP 2 ATOMS=(1 4) XBONDS=(1 3) BRKXYZ=(9 -0.250000 0.433000 0.000000-\nM  V30  0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS=-\nM  V30 LGRP\nM  V30 3 SUP 3 ATOMS=(2 1 2) XBONDS=(2 2 3) BRKXYZ=(9 0.250000 0.433000 0.000-\nM  V30 000 0.250000 -0.433000 0.000000 0.000000 0.000000 0.000000) LABEL=_Pep-\nM  V30 tide1 CLASS=AA SAP=(3 2 3 Al) SAP=(3 2 4 Br) NATREPLACE=AA/A\nM  V30 END SGROUP\nM  V30 END CTAB\nM  V30 END TEMPLATE\nM  END\n>  <type>\nmonomerTemplate\n\n>  <modificationTypes>\nConvert to _Peptide1;Convert to _Peptide1 one more;Convert to _Peptide1 one more time;\n\n>  <aliasHELM>\n_Peptide1_HELM\n\n$$$$\n';
  const error = await updateMonomersLibrary(page, sdfFile);
  expect(error).toBeNull();
  expect(await Library(page).isMonomerExist(Peptide._Peptide1)).toBeTruthy();
});

test('Case 5: Verify library update functionality: Phosphate', async () => {
  /*
   * Test case: https://github.com/epam/ketcher/issues/8345
   * Description: Upload _Phosphate1 phosphate to the library
   * Scenario:
   * 1. Go to Macro mode
   * 2. Execute command in console to add _Phosphate1 to the library
   * 3. Check that the structure appears in the Library
   *
   * Version 3.9
   */
  const sdfFile =
    '\n  -INDIGO-10092513102D\n\n  0  0  0  0  0  0  0  0  0  0  0 V3000\nM  V30 BEGIN CTAB\nM  V30 COUNTS 1 0 0 0 0\nM  V30 BEGIN ATOM\nM  V30 1 _Phosphate1 11.8462 -10.075 0.0 0 CLASS=PHOSPHATE SEQID=1\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 END BOND\nM  V30 END CTAB\nM  V30 BEGIN TEMPLATE\nM  V30 TEMPLATE 1 PHOSPHATE/_Phosphate1/_Phosphate1 NATREPLACE=PHOSPHATE/P\nM  V30 BEGIN CTAB\nM  V30 COUNTS 16 15 6 0 0\nM  V30 BEGIN ATOM\nM  V30 1 H -5.196 0.75 0.0 0\nM  V30 2 C -4.33 0.25 0.0 0\nM  V30 3 C -3.464 0.75 0.0 0\nM  V30 4 C -2.598 0.25 0.0 0\nM  V30 5 C -1.732 0.75 0.0 0\nM  V30 6 C -0.866 0.25 0.0 0\nM  V30 7 C 0.0 0.75 0.0 0\nM  V30 8 C 0.866 0.25 0.0 0\nM  V30 9 C 1.732 0.75 0.0 0\nM  V30 10 C 2.598 0.25 0.0 0\nM  V30 11 C 3.464 0.75 0.0 0\nM  V30 12 C 4.33 0.25 0.0 0\nM  V30 13 H 5.196 0.75 0.0 0\nM  V30 14 H -4.33 -0.75 0.0 0\nM  V30 15 H -2.598 -0.75 0.0 0\nM  V30 16 H -0.866 -0.75 0.0 0\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 1 1 1 2\nM  V30 2 1 2 3\nM  V30 3 1 3 4\nM  V30 4 1 4 5\nM  V30 5 1 5 6\nM  V30 6 1 6 7\nM  V30 7 1 7 8\nM  V30 8 1 8 9\nM  V30 9 1 9 10\nM  V30 10 1 10 11\nM  V30 11 1 11 12\nM  V30 12 1 12 13\nM  V30 13 1 2 14\nM  V30 14 1 4 15\nM  V30 15 1 6 16\nM  V30 END BOND\nM  V30 BEGIN SGROUP\nM  V30 1 SUP 1 ATOMS=(1 1) XBONDS=(1 1) BRKXYZ=(9 0.433000 -0.250000 0.000000-\nM  V30  0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS=-\nM  V30 LGRP\nM  V30 2 SUP 2 ATOMS=(1 13) XBONDS=(1 12) BRKXYZ=(9 -0.433000 -0.250000 0.000-\nM  V30 000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLA-\nM  V30 SS=LGRP\nM  V30 3 SUP 3 ATOMS=(1 14) XBONDS=(1 13) BRKXYZ=(9 0.000000 0.500000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 4 SUP 4 ATOMS=(1 15) XBONDS=(1 14) BRKXYZ=(9 0.000000 0.500000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 5 SUP 5 ATOMS=(1 16) XBONDS=(1 15) BRKXYZ=(9 0.000000 0.500000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 6 SUP 6 ATOMS=(11 2 3 4 5 6 7 8 9 10 11 12) XBONDS=(5 1 13 14 15 12) B-\nM  V30 RKXYZ=(9 -0.433000 0.250000 0.000000 0.000000 -0.500000 0.000000 0.000-\nM  V30 000 0.000000 0.000000) BRKXYZ=(9 0.000000 -0.500000 0.000000 0.000000 -\nM  V30 -0.500000 0.000000 0.000000 0.000000 0.000000) BRKXYZ=(9 0.433000 0.25-\nM  V30 0000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) L-\nM  V30 ABEL=_Phosphate1 CLASS=PHOSPHATE SAP=(3 2 1 Al) SAP=(3 12 13 Br) SAP=(-\nM  V30 3 2 14 Cx) SAP=(3 4 15 Dx) SAP=(3 6 16 Ex) NATREPLACE=PHOSPHATE/P\nM  V30 END SGROUP\nM  V30 END CTAB\nM  V30 END TEMPLATE\nM  END\n>  <type>\nmonomerTemplate\n\n>  <aliasHELM>\n_Phosphate_HELM\n\n>  <idtAliases>\nbase=_Phosphate1\n\n$$$$\n';
  const error = await updateMonomersLibrary(page, sdfFile);
  expect(error).toBeNull();
  expect(
    await Library(page).isMonomerExist(Phosphate._Phosphate1),
  ).toBeTruthy();
});

test('Case 6: Verify library update functionality: Preset _A1', async () => {
  /*
   * Test case: https://github.com/epam/ketcher/issues/8345
   * Description: Upload _A1 preset to the library
   * Scenario:
   * 1. Go to Macro mode
   * 2. Execute command in console to add _A1 to the library
   * 3. Check that the structure appears in the Library
   *
   * Version 3.9
   */
  const sdfFile =
    '\n  -INDIGO-10092514292D\n\n  0  0  0  0  0  0  0  0  0  0  0 V3000\nM  V30 BEGIN CTAB\nM  V30 COUNTS 3 2 0 0 0\nM  V30 BEGIN ATOM\nM  V30 1 Base1 7.7 -8.025 0.0 0 CLASS=BASE SEQID=1 ATTCHORD=(2 3 Al)\nM  V30 2 Phosphate1 9.2 -6.525 0.0 0 CLASS=PHOSPHATE SEQID=1 ATTCHORD=(2 3 Al-\nM  V30 )\nM  V30 3 Sugar1 7.7 -6.525 0.0 0 CLASS=SUGAR SEQID=1 ATTCHORD=(4 1 Cx 2 Br)\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 1 1 3 1\nM  V30 2 1 3 2\nM  V30 END BOND\nM  V30 END CTAB\nM  V30 BEGIN TEMPLATE\nM  V30 TEMPLATE 1 BASE/Base1/Base1 NATREPLACE=BASE/U\nM  V30 BEGIN CTAB\nM  V30 COUNTS 13 12 5 0 0\nM  V30 BEGIN ATOM\nM  V30 1 H -4.33 0.75 0.0 0\nM  V30 2 C -3.464 0.25 0.0 0\nM  V30 3 C -2.598 0.75 0.0 0\nM  V30 4 C -1.732 0.25 0.0 0\nM  V30 5 C -0.866 0.75 0.0 0\nM  V30 6 C 0.0 0.25 0.0 0\nM  V30 7 C 0.866 0.75 0.0 0\nM  V30 8 C 1.732 0.25 0.0 0\nM  V30 9 C 2.598 0.75 0.0 0\nM  V30 10 C 3.464 0.25 0.0 0\nM  V30 11 H 4.33 0.75 0.0 0\nM  V30 12 H -3.464 -0.75 0.0 0\nM  V30 13 H -1.732 -0.75 0.0 0\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 1 1 1 2\nM  V30 2 1 2 3\nM  V30 3 1 3 4\nM  V30 4 1 4 5\nM  V30 5 1 5 6\nM  V30 6 1 6 7\nM  V30 7 1 7 8\nM  V30 8 1 8 9\nM  V30 9 1 9 10\nM  V30 10 1 10 11\nM  V30 11 1 2 12\nM  V30 12 1 4 13\nM  V30 END BOND\nM  V30 BEGIN SGROUP\nM  V30 1 SUP 1 ATOMS=(1 1) XBONDS=(1 1) BRKXYZ=(9 0.433000 -0.250000 0.000000-\nM  V30  0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS=-\nM  V30 LGRP\nM  V30 2 SUP 2 ATOMS=(1 11) XBONDS=(1 10) BRKXYZ=(9 -0.433000 -0.250000 0.000-\nM  V30 000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLA-\nM  V30 SS=LGRP\nM  V30 3 SUP 3 ATOMS=(1 12) XBONDS=(1 11) BRKXYZ=(9 0.000000 0.500000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 4 SUP 4 ATOMS=(1 13) XBONDS=(1 12) BRKXYZ=(9 0.000000 0.500000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 5 SUP 5 ATOMS=(9 2 3 4 5 6 7 8 9 10) XBONDS=(4 1 11 12 10) BRKXYZ=(9 --\nM  V30 0.433000 0.250000 0.000000 0.000000 -0.500000 0.000000 0.000000 0.0000-\nM  V30 00 0.000000) BRKXYZ=(9 0.000000 -0.500000 0.000000 0.433000 0.250000 0-\nM  V30 .000000 0.000000 0.000000 0.000000) LABEL=Base1 CLASS=BASE SAP=(3 2 1 -\nM  V30 Al) SAP=(3 10 11 Br) SAP=(3 2 12 Cx) SAP=(3 4 13 Dx) NATREPLACE=BASE/U\nM  V30 END SGROUP\nM  V30 END CTAB\nM  V30 TEMPLATE 2 PHOSPHATE/Phosphate1/Phosphate1 NATREPLACE=PHOSPHATE/P\nM  V30 BEGIN CTAB\nM  V30 COUNTS 16 15 6 0 0\nM  V30 BEGIN ATOM\nM  V30 1 H -5.196 0.75 0.0 0\nM  V30 2 C -4.33 0.25 0.0 0\nM  V30 3 C -3.464 0.75 0.0 0\nM  V30 4 C -2.598 0.25 0.0 0\nM  V30 5 C -1.732 0.75 0.0 0\nM  V30 6 C -0.866 0.25 0.0 0\nM  V30 7 C 0.0 0.75 0.0 0\nM  V30 8 C 0.866 0.25 0.0 0\nM  V30 9 C 1.732 0.75 0.0 0\nM  V30 10 C 2.598 0.25 0.0 0\nM  V30 11 C 3.464 0.75 0.0 0\nM  V30 12 C 4.33 0.25 0.0 0\nM  V30 13 H 5.196 0.75 0.0 0\nM  V30 14 H -4.33 -0.75 0.0 0\nM  V30 15 H -2.598 -0.75 0.0 0\nM  V30 16 H -0.866 -0.75 0.0 0\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 1 1 1 2\nM  V30 2 1 2 3\nM  V30 3 1 3 4\nM  V30 4 1 4 5\nM  V30 5 1 5 6\nM  V30 6 1 6 7\nM  V30 7 1 7 8\nM  V30 8 1 8 9\nM  V30 9 1 9 10\nM  V30 10 1 10 11\nM  V30 11 1 11 12\nM  V30 12 1 12 13\nM  V30 13 1 2 14\nM  V30 14 1 4 15\nM  V30 15 1 6 16\nM  V30 END BOND\nM  V30 BEGIN SGROUP\nM  V30 1 SUP 1 ATOMS=(1 1) XBONDS=(1 1) BRKXYZ=(9 0.433000 -0.250000 0.000000-\nM  V30  0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS=-\nM  V30 LGRP\nM  V30 2 SUP 2 ATOMS=(1 13) XBONDS=(1 12) BRKXYZ=(9 -0.433000 -0.250000 0.000-\nM  V30 000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLA-\nM  V30 SS=LGRP\nM  V30 3 SUP 3 ATOMS=(1 14) XBONDS=(1 13) BRKXYZ=(9 0.000000 0.500000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 4 SUP 4 ATOMS=(1 15) XBONDS=(1 14) BRKXYZ=(9 0.000000 0.500000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 5 SUP 5 ATOMS=(1 16) XBONDS=(1 15) BRKXYZ=(9 0.000000 0.500000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 6 SUP 6 ATOMS=(11 2 3 4 5 6 7 8 9 10 11 12) XBONDS=(5 1 13 14 15 12) B-\nM  V30 RKXYZ=(9 -0.433000 0.250000 0.000000 0.000000 -0.500000 0.000000 0.000-\nM  V30 000 0.000000 0.000000) BRKXYZ=(9 0.000000 -0.500000 0.000000 0.000000 -\nM  V30 -0.500000 0.000000 0.000000 0.000000 0.000000) BRKXYZ=(9 0.433000 0.25-\nM  V30 0000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) L-\nM  V30 ABEL=Phosphate1 CLASS=PHOSPHATE SAP=(3 2 1 Al) SAP=(3 12 13 Br) SAP=(3-\nM  V30  2 14 Cx) SAP=(3 4 15 Dx) SAP=(3 6 16 Ex) NATREPLACE=PHOSPHATE/P\nM  V30 END SGROUP\nM  V30 END CTAB\nM  V30 TEMPLATE 3 SUGAR/Sugar1/Sugar1 NATREPLACE=SUGAR/R\nM  V30 BEGIN CTAB\nM  V30 COUNTS 14 13 4 0 0\nM  V30 BEGIN ATOM\nM  V30 1 H -5.196 0.75 0.0 0\nM  V30 2 C -4.33 0.25 0.0 0\nM  V30 3 C -3.464 0.75 0.0 0\nM  V30 4 C -2.598 0.25 0.0 0\nM  V30 5 C -1.732 0.75 0.0 0\nM  V30 6 C -0.866 0.25 0.0 0\nM  V30 7 C 0.0 0.75 0.0 0\nM  V30 8 C 0.866 0.25 0.0 0\nM  V30 9 C 1.732 0.75 0.0 0\nM  V30 10 C 2.598 0.25 0.0 0\nM  V30 11 C 3.464 0.75 0.0 0\nM  V30 12 C 4.33 0.25 0.0 0\nM  V30 13 H 5.196 0.75 0.0 0\nM  V30 14 H -4.33 -0.75 0.0 0\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 1 1 1 2\nM  V30 2 1 2 3\nM  V30 3 1 3 4\nM  V30 4 1 4 5\nM  V30 5 1 5 6\nM  V30 6 1 6 7\nM  V30 7 1 7 8\nM  V30 8 1 8 9\nM  V30 9 1 9 10\nM  V30 10 1 10 11\nM  V30 11 1 11 12\nM  V30 12 1 12 13\nM  V30 13 1 2 14\nM  V30 END BOND\nM  V30 BEGIN SGROUP\nM  V30 1 SUP 1 ATOMS=(1 1) XBONDS=(1 1) BRKXYZ=(9 0.433000 -0.250000 0.000000-\nM  V30  0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS=-\nM  V30 LGRP\nM  V30 2 SUP 2 ATOMS=(1 13) XBONDS=(1 12) BRKXYZ=(9 -0.433000 -0.250000 0.000-\nM  V30 000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLA-\nM  V30 SS=LGRP\nM  V30 3 SUP 3 ATOMS=(1 14) XBONDS=(1 13) BRKXYZ=(9 0.000000 0.500000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 4 SUP 4 ATOMS=(11 2 3 4 5 6 7 8 9 10 11 12) XBONDS=(3 1 13 12) BRKXYZ=-\nM  V30 (9 -0.433000 0.250000 0.000000 0.000000 -0.500000 0.000000 0.000000 0.-\nM  V30 000000 0.000000) BRKXYZ=(9 0.433000 0.250000 0.000000 0.000000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000) LABEL=Sugar1 CLASS=SUGAR SAP=(3-\nM  V30  2 1 Al) SAP=(3 12 13 Br) SAP=(3 2 14 Cx) NATREPLACE=SUGAR/R\nM  V30 END SGROUP\nM  V30 END CTAB\nM  V30 END TEMPLATE\nM  END\n>  <type>\nmonomerGroupTemplate\n\n>  <groupClass>\nRNA\n\n>  <groupName>\n_A1\n\n>  <idtAliases>\nbase=r_A1\n\n$$$$\n';
  const error = await updateMonomersLibrary(page, sdfFile);
  expect(error).toBeNull();
  expect(await Library(page).isMonomerExist(Preset._A1)).toBeTruthy();
});

test('Case 7: Verify library update functionality: Sugar', async () => {
  /*
   * Test case: https://github.com/epam/ketcher/issues/8345
   * Description: Upload _Sugar1 sugar to the library
   * Scenario:
   * 1. Go to Macro mode
   * 2. Execute command in console to add _Sugar1 to the library
   * 3. Check that the structure appears in the Library
   *
   * Version 3.9
   */
  const sdfFile =
    '\n  -INDIGO-10092512212D\n\n  0  0  0  0  0  0  0  0  0  0  0 V3000\nM  V30 BEGIN CTAB\nM  V30 COUNTS 1 0 0 0 0\nM  V30 BEGIN ATOM\nM  V30 1 _Sugar1 10.4962 -10.55 0.0 0 CLASS=SUGAR SEQID=1\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 END BOND\nM  V30 END CTAB\nM  V30 BEGIN TEMPLATE\nM  V30 TEMPLATE 1 SUGAR/_Sugar1/_Sugar1 NATREPLACE=SUGAR/R\nM  V30 BEGIN CTAB\nM  V30 COUNTS 14 13 4 0 0\nM  V30 BEGIN ATOM\nM  V30 1 H -5.196 0.75 0.0 0\nM  V30 2 C -4.33 0.25 0.0 0\nM  V30 3 C -3.464 0.75 0.0 0\nM  V30 4 C -2.598 0.25 0.0 0\nM  V30 5 C -1.732 0.75 0.0 0\nM  V30 6 C -0.866 0.25 0.0 0\nM  V30 7 C 0.0 0.75 0.0 0\nM  V30 8 C 0.866 0.25 0.0 0\nM  V30 9 C 1.732 0.75 0.0 0\nM  V30 10 C 2.598 0.25 0.0 0\nM  V30 11 C 3.464 0.75 0.0 0\nM  V30 12 C 4.33 0.25 0.0 0\nM  V30 13 H 5.196 0.75 0.0 0\nM  V30 14 H -4.33 -0.75 0.0 0\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 1 1 1 2\nM  V30 2 1 2 3\nM  V30 3 1 3 4\nM  V30 4 1 4 5\nM  V30 5 1 5 6\nM  V30 6 1 6 7\nM  V30 7 1 7 8\nM  V30 8 1 8 9\nM  V30 9 1 9 10\nM  V30 10 1 10 11\nM  V30 11 1 11 12\nM  V30 12 1 12 13\nM  V30 13 1 2 14\nM  V30 END BOND\nM  V30 BEGIN SGROUP\nM  V30 1 SUP 1 ATOMS=(1 1) XBONDS=(1 1) BRKXYZ=(9 0.433000 -0.250000 0.000000-\nM  V30  0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS=-\nM  V30 LGRP\nM  V30 2 SUP 2 ATOMS=(1 13) XBONDS=(1 12) BRKXYZ=(9 -0.433000 -0.250000 0.000-\nM  V30 000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLA-\nM  V30 SS=LGRP\nM  V30 3 SUP 3 ATOMS=(1 14) XBONDS=(1 13) BRKXYZ=(9 0.000000 0.500000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 4 SUP 4 ATOMS=(11 2 3 4 5 6 7 8 9 10 11 12) XBONDS=(3 1 13 12) BRKXYZ=-\nM  V30 (9 -0.433000 0.250000 0.000000 0.000000 -0.500000 0.000000 0.000000 0.-\nM  V30 000000 0.000000) BRKXYZ=(9 0.433000 0.250000 0.000000 0.000000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000) LABEL=_Sugar1 CLASS=SUGAR SAP=(-\nM  V30 3 2 1 Al) SAP=(3 12 13 Br) SAP=(3 2 14 Cx) NATREPLACE=SUGAR/R\nM  V30 END SGROUP\nM  V30 END CTAB\nM  V30 END TEMPLATE\nM  END\n>  <type>\nmonomerTemplate\n\n>  <aliasHELM>\n_Sugar1_HELM\n\n$$$$\n';
  const error = await updateMonomersLibrary(page, sdfFile);
  expect(error).toBeNull();
  expect(await Library(page).isMonomerExist(Sugar._Sugar1)).toBeTruthy();
});

const _Base1Body =
  '\n  -INDIGO-10092512402D\n\n  0  0  0  0  0  0  0  0  0  0  0 V3000\nM  V30 BEGIN CTAB\nM  V30 COUNTS 1 0 0 0 0\nM  V30 BEGIN ATOM\nM  V30 1 _Base1 10.9051 -9.2 0.0 0 CLASS=BASE\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 END BOND\nM  V30 END CTAB\nM  V30 BEGIN TEMPLATE\nM  V30 TEMPLATE 1 BASE/_Base1/_Base1 NATREPLACE=BASE/A\nM  V30 BEGIN CTAB\nM  V30 COUNTS 13 12 5 0 0\nM  V30 BEGIN ATOM\nM  V30 1 H -4.33 0.75 0.0 0\nM  V30 2 P -3.464 0.25 0.0 0\nM  V30 3 C -2.598 0.75 0.0 0\nM  V30 4 C -1.732 0.25 0.0 0\nM  V30 5 C -0.866 0.75 0.0 0\nM  V30 6 C 0.0 0.25 0.0 0\nM  V30 7 C 0.866 0.75 0.0 0\nM  V30 8 C 1.732 0.25 0.0 0\nM  V30 9 C 2.598 0.75 0.0 0\nM  V30 10 C 3.464 0.25 0.0 0\nM  V30 11 H 4.33 0.75 0.0 0\nM  V30 12 H -3.464 -0.75 0.0 0\nM  V30 13 H -1.732 -0.75 0.0 0\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 1 1 1 2\nM  V30 2 1 2 3\nM  V30 3 1 3 4\nM  V30 4 1 4 5\nM  V30 5 1 5 6\nM  V30 6 1 6 7\nM  V30 7 1 7 8\nM  V30 8 1 8 9\nM  V30 9 1 9 10\nM  V30 10 1 10 11\nM  V30 11 1 2 12\nM  V30 12 1 4 13\nM  V30 END BOND\nM  V30 BEGIN SGROUP\nM  V30 1 SUP 1 ATOMS=(1 1) XBONDS=(1 1) BRKXYZ=(9 0.433000 -0.250000 0.000000-\nM  V30  0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS=-\nM  V30 LGRP\nM  V30 2 SUP 2 ATOMS=(1 11) XBONDS=(1 10) BRKXYZ=(9 -0.433000 -0.250000 0.000-\nM  V30 000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLA-\nM  V30 SS=LGRP\nM  V30 3 SUP 3 ATOMS=(1 12) XBONDS=(1 11) BRKXYZ=(9 0.000000 0.500000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 4 SUP 4 ATOMS=(1 13) XBONDS=(1 12) BRKXYZ=(9 0.000000 0.500000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 5 SUP 5 ATOMS=(9 2 3 4 5 6 7 8 9 10) XBONDS=(4 1 11 12 10) BRKXYZ=(9 --\nM  V30 0.433000 0.250000 0.000000 0.000000 -0.500000 0.000000 0.000000 0.0000-\nM  V30 00 0.000000) BRKXYZ=(9 0.000000 -0.500000 0.000000 0.433000 0.250000 0-\nM  V30 .000000 0.000000 0.000000 0.000000) LABEL=_Base1 CLASS=BASE SAP=(3 2 1-\nM  V30  Al) SAP=(3 10 11 Br) SAP=(3 2 12 Cx) SAP=(3 4 13 Dx) NATREPLACE=BASE/A\nM  V30 END SGROUP\nM  V30 END CTAB\nM  V30 END TEMPLATE\nM  END\n';
//   '\n  -INDIGO-10092513342D\n\n  0  0  0  0  0  0  0  0  0  0  0 V3000\nM  V30 BEGIN CTAB\nM  V30 COUNTS 1 0 0 0 0\nM  V30 BEGIN ATOM\nM  V30 1 _CHEM1 10.1551 -9.35993 0.0 0 CLASS=LINKER\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 END BOND\nM  V30 END CTAB\nM  V30 BEGIN TEMPLATE\nM  V30 TEMPLATE 1 LINKER/_CHEM1/_CHEM1\nM  V30 BEGIN CTAB\nM  V30 COUNTS 17 16 5 0 0\nM  V30 BEGIN ATOM\nM  V30 1 H -4.33 0.31 0.0 0\nM  V30 2 C -3.464 -0.19 0.0 0\nM  V30 3 P -2.598 0.31 0.0 0\nM  V30 4 P -1.732 -0.19 0.0 0\nM  V30 5 C -0.866 0.31 0.0 0\nM  V30 6 C 0.0 -0.19 0.0 0\nM  V30 7 C 0.866 0.31 0.0 0\nM  V30 8 C 1.732 -0.19 0.0 0\nM  V30 9 C 2.598 0.31 0.0 0\nM  V30 10 C 3.464 -0.19 0.0 0\nM  V30 11 H 4.33 0.31 0.0 0\nM  V30 12 C 1.573 1.017 0.0 0\nM  V30 13 C 1.314 1.983 0.0 0\nM  V30 14 H 2.021 2.69 0.0 0\nM  V30 15 C -1.732 -1.19 0.0 0\nM  V30 16 C -0.866 -1.69 0.0 0\nM  V30 17 H -0.866 -2.69 0.0 0\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 1 1 1 2\nM  V30 2 1 2 3\nM  V30 3 1 3 4\nM  V30 4 1 4 5\nM  V30 5 1 5 6\nM  V30 6 1 6 7\nM  V30 7 1 7 8\nM  V30 8 1 8 9\nM  V30 9 1 9 10\nM  V30 10 1 10 11\nM  V30 11 1 7 12\nM  V30 12 1 12 13\nM  V30 13 1 13 14\nM  V30 14 1 4 15\nM  V30 15 1 15 16\nM  V30 16 1 16 17\nM  V30 END BOND\nM  V30 BEGIN SGROUP\nM  V30 1 SUP 1 ATOMS=(1 1) XBONDS=(1 1) BRKXYZ=(9 0.433000 -0.250000 0.000000-\nM  V30  0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS=-\nM  V30 LGRP\nM  V30 2 SUP 2 ATOMS=(1 11) XBONDS=(1 10) BRKXYZ=(9 -0.433000 -0.250000 0.000-\nM  V30 000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLA-\nM  V30 SS=LGRP\nM  V30 3 SUP 3 ATOMS=(1 14) XBONDS=(1 13) BRKXYZ=(9 -0.353500 -0.353500 0.000-\nM  V30 000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLA-\nM  V30 SS=LGRP\nM  V30 4 SUP 4 ATOMS=(1 17) XBONDS=(1 16) BRKXYZ=(9 0.000000 0.500000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 5 SUP 5 ATOMS=(13 2 3 4 5 6 7 8 9 10 12 13 15 16) XBONDS=(4 1 10 13 16-\nM  V30 ) BRKXYZ=(9 -0.433000 0.250000 0.000000 0.433000 0.250000 0.000000 0.0-\nM  V30 00000 0.000000 0.000000) BRKXYZ=(9 0.353500 0.353500 0.000000 0.000000-\nM  V30  -0.500000 0.000000 0.000000 0.000000 0.000000) LABEL=_CHEM1 CLASS=LIN-\nM  V30 KER SAP=(3 2 1 Al) SAP=(3 10 11 Br) SAP=(3 13 14 Cx) SAP=(3 16 17 Dx)\nM  V30 END SGROUP\nM  V30 END CTAB\nM  V30 END TEMPLATE\nM  END\n';
const _Nucleotide1Body =
  '\n  -INDIGO-10122513312D\n\n  0  0  0  0  0  0  0  0  0  0  0 V3000\nM  V30 BEGIN CTAB\nM  V30 COUNTS 1 0 0 0 0\nM  V30 BEGIN ATOM\nM  V30 1 _Nucleotide1 9.9 -9.35 0.0 0 CLASS=RNA SEQID=1\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 END BOND\nM  V30 END CTAB\nM  V30 BEGIN TEMPLATE\nM  V30 TEMPLATE 1 RNA/_Nucleotide1/_Nucleotide1 NATREPLACE=RNA/A\nM  V30 BEGIN CTAB\nM  V30 COUNTS 5 4 4 0 0\nM  V30 BEGIN ATOM\nM  V30 1 C -0.866 -0.75 0.0 0\nM  V30 2 C 0.0 -0.25 0.0 0\nM  V30 3 H 0.0 0.75 0.0 0\nM  V30 4 H 0.866 -0.75 0.0 0\nM  V30 5 H 0.866 0.25 0.0 0\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 1 1 1 2\nM  V30 2 1 2 3\nM  V30 3 1 2 4\nM  V30 4 1 2 5\nM  V30 END BOND\nM  V30 BEGIN SGROUP\nM  V30 1 SUP 1 ATOMS=(1 3) XBONDS=(1 2) BRKXYZ=(9 0.000000 -0.500000 0.000000-\nM  V30  0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS=-\nM  V30 LGRP\nM  V30 2 SUP 2 ATOMS=(1 5) XBONDS=(1 4) BRKXYZ=(9 -0.433000 -0.250000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 3 SUP 3 ATOMS=(1 4) XBONDS=(1 3) BRKXYZ=(9 -0.433000 0.250000 0.000000-\nM  V30  0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS=-\nM  V30 LGRP\nM  V30 4 SUP 4 ATOMS=(2 1 2) XBONDS=(3 2 3 4) BRKXYZ=(9 0.000000 0.500000 0.0-\nM  V30 00000 0.433000 -0.250000 0.000000 0.000000 0.000000 0.000000) BRKXYZ=(-\nM  V30 9 0.433000 0.250000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000-\nM  V30 000 0.000000) LABEL=_Nucleotide1 CLASS=RNA SAP=(3 2 3 Al) SAP=(3 2 5 B-\nM  V30 r) SAP=(3 2 4 Cx) NATREPLACE=RNA/A\nM  V30 END SGROUP\nM  V30 END CTAB\nM  V30 END TEMPLATE\nM  END\n';
const _Peptide1Body =
  '\n  -INDIGO-10122515372D\n\n  0  0  0  0  0  0  0  0  0  0  0 V3000\nM  V30 BEGIN CTAB\nM  V30 COUNTS 1 0 0 0 0\nM  V30 BEGIN ATOM\nM  V30 1 _Peptide1 11.975 -7.85 0.0 0 CLASS=AA SEQID=1\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 END BOND\nM  V30 END CTAB\nM  V30 BEGIN TEMPLATE\nM  V30 TEMPLATE 1 AA/_Peptide1/_Peptide1/ NATREPLACE=AA/A\nM  V30 BEGIN CTAB\nM  V30 COUNTS 4 3 3 0 0\nM  V30 BEGIN ATOM\nM  V30 1 C -0.75 0.0 0.0 0\nM  V30 2 C 0.25 0.0 0.0 0\nM  V30 3 H 0.75 0.866 0.0 0\nM  V30 4 H 0.75 -0.866 0.0 0\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 1 2 1 2\nM  V30 2 1 2 3\nM  V30 3 1 2 4\nM  V30 END BOND\nM  V30 BEGIN SGROUP\nM  V30 1 SUP 1 ATOMS=(1 3) XBONDS=(1 2) BRKXYZ=(9 -0.250000 -0.433000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 2 SUP 2 ATOMS=(1 4) XBONDS=(1 3) BRKXYZ=(9 -0.250000 0.433000 0.000000-\nM  V30  0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS=-\nM  V30 LGRP\nM  V30 3 SUP 3 ATOMS=(2 1 2) XBONDS=(2 2 3) BRKXYZ=(9 0.250000 0.433000 0.000-\nM  V30 000 0.250000 -0.433000 0.000000 0.000000 0.000000 0.000000) LABEL=_Pep-\nM  V30 tide1 CLASS=AA SAP=(3 2 3 Al) SAP=(3 2 4 Br) NATREPLACE=AA/A\nM  V30 END SGROUP\nM  V30 END CTAB\nM  V30 END TEMPLATE\nM  END\n';
const _Phosphate1Body =
  '\n  -INDIGO-10092513102D\n\n  0  0  0  0  0  0  0  0  0  0  0 V3000\nM  V30 BEGIN CTAB\nM  V30 COUNTS 1 0 0 0 0\nM  V30 BEGIN ATOM\nM  V30 1 _Phosphate1 11.8462 -10.075 0.0 0 CLASS=PHOSPHATE SEQID=1\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 END BOND\nM  V30 END CTAB\nM  V30 BEGIN TEMPLATE\nM  V30 TEMPLATE 1 PHOSPHATE/_Phosphate1/_Phosphate1 NATREPLACE=PHOSPHATE/P\nM  V30 BEGIN CTAB\nM  V30 COUNTS 16 15 6 0 0\nM  V30 BEGIN ATOM\nM  V30 1 H -5.196 0.75 0.0 0\nM  V30 2 C -4.33 0.25 0.0 0\nM  V30 3 C -3.464 0.75 0.0 0\nM  V30 4 C -2.598 0.25 0.0 0\nM  V30 5 C -1.732 0.75 0.0 0\nM  V30 6 C -0.866 0.25 0.0 0\nM  V30 7 C 0.0 0.75 0.0 0\nM  V30 8 C 0.866 0.25 0.0 0\nM  V30 9 C 1.732 0.75 0.0 0\nM  V30 10 C 2.598 0.25 0.0 0\nM  V30 11 C 3.464 0.75 0.0 0\nM  V30 12 C 4.33 0.25 0.0 0\nM  V30 13 H 5.196 0.75 0.0 0\nM  V30 14 H -4.33 -0.75 0.0 0\nM  V30 15 H -2.598 -0.75 0.0 0\nM  V30 16 H -0.866 -0.75 0.0 0\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 1 1 1 2\nM  V30 2 1 2 3\nM  V30 3 1 3 4\nM  V30 4 1 4 5\nM  V30 5 1 5 6\nM  V30 6 1 6 7\nM  V30 7 1 7 8\nM  V30 8 1 8 9\nM  V30 9 1 9 10\nM  V30 10 1 10 11\nM  V30 11 1 11 12\nM  V30 12 1 12 13\nM  V30 13 1 2 14\nM  V30 14 1 4 15\nM  V30 15 1 6 16\nM  V30 END BOND\nM  V30 BEGIN SGROUP\nM  V30 1 SUP 1 ATOMS=(1 1) XBONDS=(1 1) BRKXYZ=(9 0.433000 -0.250000 0.000000-\nM  V30  0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS=-\nM  V30 LGRP\nM  V30 2 SUP 2 ATOMS=(1 13) XBONDS=(1 12) BRKXYZ=(9 -0.433000 -0.250000 0.000-\nM  V30 000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLA-\nM  V30 SS=LGRP\nM  V30 3 SUP 3 ATOMS=(1 14) XBONDS=(1 13) BRKXYZ=(9 0.000000 0.500000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 4 SUP 4 ATOMS=(1 15) XBONDS=(1 14) BRKXYZ=(9 0.000000 0.500000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 5 SUP 5 ATOMS=(1 16) XBONDS=(1 15) BRKXYZ=(9 0.000000 0.500000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 6 SUP 6 ATOMS=(11 2 3 4 5 6 7 8 9 10 11 12) XBONDS=(5 1 13 14 15 12) B-\nM  V30 RKXYZ=(9 -0.433000 0.250000 0.000000 0.000000 -0.500000 0.000000 0.000-\nM  V30 000 0.000000 0.000000) BRKXYZ=(9 0.000000 -0.500000 0.000000 0.000000 -\nM  V30 -0.500000 0.000000 0.000000 0.000000 0.000000) BRKXYZ=(9 0.433000 0.25-\nM  V30 0000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) L-\nM  V30 ABEL=_Phosphate1 CLASS=PHOSPHATE SAP=(3 2 1 Al) SAP=(3 12 13 Br) SAP=(-\nM  V30 3 2 14 Cx) SAP=(3 4 15 Dx) SAP=(3 6 16 Ex) NATREPLACE=PHOSPHATE/P\nM  V30 END SGROUP\nM  V30 END CTAB\nM  V30 END TEMPLATE\nM  END\n';
const _A1Body =
  '\n  -INDIGO-10092514292D\n\n  0  0  0  0  0  0  0  0  0  0  0 V3000\nM  V30 BEGIN CTAB\nM  V30 COUNTS 3 2 0 0 0\nM  V30 BEGIN ATOM\nM  V30 1 Base1 7.7 -8.025 0.0 0 CLASS=BASE SEQID=1 ATTCHORD=(2 3 Al)\nM  V30 2 Phosphate1 9.2 -6.525 0.0 0 CLASS=PHOSPHATE SEQID=1 ATTCHORD=(2 3 Al-\nM  V30 )\nM  V30 3 Sugar1 7.7 -6.525 0.0 0 CLASS=SUGAR SEQID=1 ATTCHORD=(4 1 Cx 2 Br)\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 1 1 3 1\nM  V30 2 1 3 2\nM  V30 END BOND\nM  V30 END CTAB\nM  V30 BEGIN TEMPLATE\nM  V30 TEMPLATE 1 BASE/Base1/Base1 NATREPLACE=BASE/U\nM  V30 BEGIN CTAB\nM  V30 COUNTS 13 12 5 0 0\nM  V30 BEGIN ATOM\nM  V30 1 H -4.33 0.75 0.0 0\nM  V30 2 C -3.464 0.25 0.0 0\nM  V30 3 C -2.598 0.75 0.0 0\nM  V30 4 C -1.732 0.25 0.0 0\nM  V30 5 C -0.866 0.75 0.0 0\nM  V30 6 C 0.0 0.25 0.0 0\nM  V30 7 C 0.866 0.75 0.0 0\nM  V30 8 C 1.732 0.25 0.0 0\nM  V30 9 C 2.598 0.75 0.0 0\nM  V30 10 C 3.464 0.25 0.0 0\nM  V30 11 H 4.33 0.75 0.0 0\nM  V30 12 H -3.464 -0.75 0.0 0\nM  V30 13 H -1.732 -0.75 0.0 0\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 1 1 1 2\nM  V30 2 1 2 3\nM  V30 3 1 3 4\nM  V30 4 1 4 5\nM  V30 5 1 5 6\nM  V30 6 1 6 7\nM  V30 7 1 7 8\nM  V30 8 1 8 9\nM  V30 9 1 9 10\nM  V30 10 1 10 11\nM  V30 11 1 2 12\nM  V30 12 1 4 13\nM  V30 END BOND\nM  V30 BEGIN SGROUP\nM  V30 1 SUP 1 ATOMS=(1 1) XBONDS=(1 1) BRKXYZ=(9 0.433000 -0.250000 0.000000-\nM  V30  0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS=-\nM  V30 LGRP\nM  V30 2 SUP 2 ATOMS=(1 11) XBONDS=(1 10) BRKXYZ=(9 -0.433000 -0.250000 0.000-\nM  V30 000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLA-\nM  V30 SS=LGRP\nM  V30 3 SUP 3 ATOMS=(1 12) XBONDS=(1 11) BRKXYZ=(9 0.000000 0.500000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 4 SUP 4 ATOMS=(1 13) XBONDS=(1 12) BRKXYZ=(9 0.000000 0.500000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 5 SUP 5 ATOMS=(9 2 3 4 5 6 7 8 9 10) XBONDS=(4 1 11 12 10) BRKXYZ=(9 --\nM  V30 0.433000 0.250000 0.000000 0.000000 -0.500000 0.000000 0.000000 0.0000-\nM  V30 00 0.000000) BRKXYZ=(9 0.000000 -0.500000 0.000000 0.433000 0.250000 0-\nM  V30 .000000 0.000000 0.000000 0.000000) LABEL=Base1 CLASS=BASE SAP=(3 2 1 -\nM  V30 Al) SAP=(3 10 11 Br) SAP=(3 2 12 Cx) SAP=(3 4 13 Dx) NATREPLACE=BASE/U\nM  V30 END SGROUP\nM  V30 END CTAB\nM  V30 TEMPLATE 2 PHOSPHATE/Phosphate1/Phosphate1 NATREPLACE=PHOSPHATE/P\nM  V30 BEGIN CTAB\nM  V30 COUNTS 16 15 6 0 0\nM  V30 BEGIN ATOM\nM  V30 1 H -5.196 0.75 0.0 0\nM  V30 2 C -4.33 0.25 0.0 0\nM  V30 3 C -3.464 0.75 0.0 0\nM  V30 4 C -2.598 0.25 0.0 0\nM  V30 5 C -1.732 0.75 0.0 0\nM  V30 6 C -0.866 0.25 0.0 0\nM  V30 7 C 0.0 0.75 0.0 0\nM  V30 8 C 0.866 0.25 0.0 0\nM  V30 9 C 1.732 0.75 0.0 0\nM  V30 10 C 2.598 0.25 0.0 0\nM  V30 11 C 3.464 0.75 0.0 0\nM  V30 12 C 4.33 0.25 0.0 0\nM  V30 13 H 5.196 0.75 0.0 0\nM  V30 14 H -4.33 -0.75 0.0 0\nM  V30 15 H -2.598 -0.75 0.0 0\nM  V30 16 H -0.866 -0.75 0.0 0\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 1 1 1 2\nM  V30 2 1 2 3\nM  V30 3 1 3 4\nM  V30 4 1 4 5\nM  V30 5 1 5 6\nM  V30 6 1 6 7\nM  V30 7 1 7 8\nM  V30 8 1 8 9\nM  V30 9 1 9 10\nM  V30 10 1 10 11\nM  V30 11 1 11 12\nM  V30 12 1 12 13\nM  V30 13 1 2 14\nM  V30 14 1 4 15\nM  V30 15 1 6 16\nM  V30 END BOND\nM  V30 BEGIN SGROUP\nM  V30 1 SUP 1 ATOMS=(1 1) XBONDS=(1 1) BRKXYZ=(9 0.433000 -0.250000 0.000000-\nM  V30  0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS=-\nM  V30 LGRP\nM  V30 2 SUP 2 ATOMS=(1 13) XBONDS=(1 12) BRKXYZ=(9 -0.433000 -0.250000 0.000-\nM  V30 000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLA-\nM  V30 SS=LGRP\nM  V30 3 SUP 3 ATOMS=(1 14) XBONDS=(1 13) BRKXYZ=(9 0.000000 0.500000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 4 SUP 4 ATOMS=(1 15) XBONDS=(1 14) BRKXYZ=(9 0.000000 0.500000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 5 SUP 5 ATOMS=(1 16) XBONDS=(1 15) BRKXYZ=(9 0.000000 0.500000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 6 SUP 6 ATOMS=(11 2 3 4 5 6 7 8 9 10 11 12) XBONDS=(5 1 13 14 15 12) B-\nM  V30 RKXYZ=(9 -0.433000 0.250000 0.000000 0.000000 -0.500000 0.000000 0.000-\nM  V30 000 0.000000 0.000000) BRKXYZ=(9 0.000000 -0.500000 0.000000 0.000000 -\nM  V30 -0.500000 0.000000 0.000000 0.000000 0.000000) BRKXYZ=(9 0.433000 0.25-\nM  V30 0000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) L-\nM  V30 ABEL=Phosphate1 CLASS=PHOSPHATE SAP=(3 2 1 Al) SAP=(3 12 13 Br) SAP=(3-\nM  V30  2 14 Cx) SAP=(3 4 15 Dx) SAP=(3 6 16 Ex) NATREPLACE=PHOSPHATE/P\nM  V30 END SGROUP\nM  V30 END CTAB\nM  V30 TEMPLATE 3 SUGAR/Sugar1/Sugar1 NATREPLACE=SUGAR/R\nM  V30 BEGIN CTAB\nM  V30 COUNTS 14 13 4 0 0\nM  V30 BEGIN ATOM\nM  V30 1 H -5.196 0.75 0.0 0\nM  V30 2 C -4.33 0.25 0.0 0\nM  V30 3 C -3.464 0.75 0.0 0\nM  V30 4 C -2.598 0.25 0.0 0\nM  V30 5 C -1.732 0.75 0.0 0\nM  V30 6 C -0.866 0.25 0.0 0\nM  V30 7 C 0.0 0.75 0.0 0\nM  V30 8 C 0.866 0.25 0.0 0\nM  V30 9 C 1.732 0.75 0.0 0\nM  V30 10 C 2.598 0.25 0.0 0\nM  V30 11 C 3.464 0.75 0.0 0\nM  V30 12 C 4.33 0.25 0.0 0\nM  V30 13 H 5.196 0.75 0.0 0\nM  V30 14 H -4.33 -0.75 0.0 0\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 1 1 1 2\nM  V30 2 1 2 3\nM  V30 3 1 3 4\nM  V30 4 1 4 5\nM  V30 5 1 5 6\nM  V30 6 1 6 7\nM  V30 7 1 7 8\nM  V30 8 1 8 9\nM  V30 9 1 9 10\nM  V30 10 1 10 11\nM  V30 11 1 11 12\nM  V30 12 1 12 13\nM  V30 13 1 2 14\nM  V30 END BOND\nM  V30 BEGIN SGROUP\nM  V30 1 SUP 1 ATOMS=(1 1) XBONDS=(1 1) BRKXYZ=(9 0.433000 -0.250000 0.000000-\nM  V30  0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS=-\nM  V30 LGRP\nM  V30 2 SUP 2 ATOMS=(1 13) XBONDS=(1 12) BRKXYZ=(9 -0.433000 -0.250000 0.000-\nM  V30 000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLA-\nM  V30 SS=LGRP\nM  V30 3 SUP 3 ATOMS=(1 14) XBONDS=(1 13) BRKXYZ=(9 0.000000 0.500000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 4 SUP 4 ATOMS=(11 2 3 4 5 6 7 8 9 10 11 12) XBONDS=(3 1 13 12) BRKXYZ=-\nM  V30 (9 -0.433000 0.250000 0.000000 0.000000 -0.500000 0.000000 0.000000 0.-\nM  V30 000000 0.000000) BRKXYZ=(9 0.433000 0.250000 0.000000 0.000000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000) LABEL=Sugar1 CLASS=SUGAR SAP=(3-\nM  V30  2 1 Al) SAP=(3 12 13 Br) SAP=(3 2 14 Cx) NATREPLACE=SUGAR/R\nM  V30 END SGROUP\nM  V30 END CTAB\nM  V30 END TEMPLATE\nM  END\n';
//  '\n  -INDIGO-10092512212D\n\n  0  0  0  0  0  0  0  0  0  0  0 V3000\nM  V30 BEGIN CTAB\nM  V30 COUNTS 1 0 0 0 0\nM  V30 BEGIN ATOM\nM  V30 1 _Sugar1 10.4962 -10.55 0.0 0 CLASS=SUGAR SEQID=1\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 END BOND\nM  V30 END CTAB\nM  V30 BEGIN TEMPLATE\nM  V30 TEMPLATE 1 SUGAR/_Sugar1/_Sugar1 NATREPLACE=SUGAR/R\nM  V30 BEGIN CTAB\nM  V30 COUNTS 14 13 4 0 0\nM  V30 BEGIN ATOM\nM  V30 1 H -5.196 0.75 0.0 0\nM  V30 2 C -4.33 0.25 0.0 0\nM  V30 3 C -3.464 0.75 0.0 0\nM  V30 4 C -2.598 0.25 0.0 0\nM  V30 5 C -1.732 0.75 0.0 0\nM  V30 6 C -0.866 0.25 0.0 0\nM  V30 7 C 0.0 0.75 0.0 0\nM  V30 8 C 0.866 0.25 0.0 0\nM  V30 9 C 1.732 0.75 0.0 0\nM  V30 10 C 2.598 0.25 0.0 0\nM  V30 11 C 3.464 0.75 0.0 0\nM  V30 12 C 4.33 0.25 0.0 0\nM  V30 13 H 5.196 0.75 0.0 0\nM  V30 14 H -4.33 -0.75 0.0 0\nM  V30 END ATOM\nM  V30 BEGIN BOND\nM  V30 1 1 1 2\nM  V30 2 1 2 3\nM  V30 3 1 3 4\nM  V30 4 1 4 5\nM  V30 5 1 5 6\nM  V30 6 1 6 7\nM  V30 7 1 7 8\nM  V30 8 1 8 9\nM  V30 9 1 9 10\nM  V30 10 1 10 11\nM  V30 11 1 11 12\nM  V30 12 1 12 13\nM  V30 13 1 2 14\nM  V30 END BOND\nM  V30 BEGIN SGROUP\nM  V30 1 SUP 1 ATOMS=(1 1) XBONDS=(1 1) BRKXYZ=(9 0.433000 -0.250000 0.000000-\nM  V30  0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS=-\nM  V30 LGRP\nM  V30 2 SUP 2 ATOMS=(1 13) XBONDS=(1 12) BRKXYZ=(9 -0.433000 -0.250000 0.000-\nM  V30 000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLA-\nM  V30 SS=LGRP\nM  V30 3 SUP 3 ATOMS=(1 14) XBONDS=(1 13) BRKXYZ=(9 0.000000 0.500000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000) LABEL=H CLASS-\nM  V30 =LGRP\nM  V30 4 SUP 4 ATOMS=(11 2 3 4 5 6 7 8 9 10 11 12) XBONDS=(3 1 13 12) BRKXYZ=-\nM  V30 (9 -0.433000 0.250000 0.000000 0.000000 -0.500000 0.000000 0.000000 0.-\nM  V30 000000 0.000000) BRKXYZ=(9 0.433000 0.250000 0.000000 0.000000 0.00000-\nM  V30 0 0.000000 0.000000 0.000000 0.000000) LABEL=_Sugar1 CLASS=SUGAR SAP=(-\nM  V30 3 2 1 Al) SAP=(3 12 13 Br) SAP=(3 2 14 Cx) NATREPLACE=SUGAR/R\nM  V30 END SGROUP\nM  V30 END CTAB\nM  V30 END TEMPLATE\nM  END\n';

const _type = '>  <type>\n';
const _modificationTypes = '>  <modificationTypes>\n';
const _aliasHELM = '>  <aliasHELM>\n';
const _idtAliases = '>  <idtAliases>\n';
const _groupClass = '>  <groupClass>\n';
const _groupName = '>  <groupName>\n';
const _betweenEntries = '\n\n';
const _endToken = '$$$$\n';
const _emptyValue = '';

test('Case 8: Update Library item with compound that contains NON-MOLv3000 file', async () => {
  /*
   * Test case: https://github.com/epam/ketcher/issues/8345
   * Description: Update Library item with compound that contains NON-MOLv3000 file
   * Scenario:
   * 1. Go to Macro mode
   * 2. Execute command in console with compound that contains NON-MOLv3000 file
   * 3. System should return an error message
   *
   * Version 3.9
   */

  const sdfFile =
    'NON-MOLv3000 file\n' +
    _type +
    'monomerTemplate' +
    _betweenEntries +
    _endToken;

  const error = await updateMonomersLibrary(page, sdfFile);
  expect(error).not.toBeNull();
  expect(error).toContain(
    "Given string could not be loaded as (query or plain) molecule or reaction, see the error messages: 'core: Error loading monomer library: scanner: BufferScanner::read() error'",
  );
});

test('Case 9: Update Library item with compound that contains MOLv3000 file with no type defined', async () => {
  /*
   * Test case: https://github.com/epam/ketcher/issues/8345
   * Description: Update Library item with compound that contains MOLv3000 file with no type defined
   * Scenario:
   * 1. Go to Macro mode
   * 2. Execute command in console to add _Sugar1 to the library
   * 3. Check that the structure appears in the Library
   *
   * Version 3.9
   */

  const sdfFile = _Base1Body + _endToken;

  const error = await updateMonomersLibrary(page, sdfFile);
  expect(error).toBeNull();
  expect(await Library(page).isMonomerExist(Base._Base1)).toBeTruthy();
});

test('Case 10: Update Library item with compound that contains MOLv3000 file with no type defined', async () => {
  /*
   * Test case: https://github.com/epam/ketcher/issues/8345
   * Description: Update Library item with compound that contains MOLv3000 file with no type defined
   * Scenario:
   * 1. Go to Macro mode
   * 2. Execute command in console to add _Sugar1 to the library
   * 3. Check that the structure appears in the Library
   *
   * Version 3.9
   */

  const sdfFile = _Base1Body + _endToken;

  const error = await updateMonomersLibrary(page, sdfFile);
  expect(error).toBeNull();
  expect(await Library(page).isMonomerExist(Base._Base1)).toBeTruthy();
});

test.fail(
  'Case 11: Update Library item with compound that contains MOLv3000 file with aliasHELM that contain empty value',
  async () => {
    // This issues fails because of the issue: https://github.com/epam/ketcher/issues/8354
    /*
     * Test case: https://github.com/epam/ketcher/issues/8345
     * Description: Update Library item with compound that contains MOLv3000 file with aliasHELM that contain empty value
     * Scenario:
     * 1. Go to Macro mode
     * 2. Execute command in console to add _Base1 to the library with aliasHELM that contain empty value
     * 3. Check that the structure doesn't appears in the Library
     *
     * Version 3.9
     */

    const sdfFile =
      _Base1Body + _aliasHELM + _emptyValue + _betweenEntries + _endToken;

    const error = await updateMonomersLibrary(page, sdfFile);
    expect(error).toBeNull();
    expect(await Library(page).isMonomerExist(Base._Base1)).not.toBeTruthy();
  },
);

test.fail(
  'Case 12: Update Library item with compound that contains MOLv3000 file with aliasHELM that contain one space as value',
  async () => {
    // This issues fails because of the issue: https://github.com/epam/ketcher/issues/8143
    /*
     * Test case: https://github.com/epam/ketcher/issues/8345
     * Description: Update Library item with compound that contains MOLv3000 file with aliasHELM that contain one space as value
     * Scenario:
     * 1. Go to Macro mode
     * 2. Execute command in console
     * 3. Check that the structure doesn't appears in the Library
     *
     * Version 3.9
     */

    const sdfFile =
      _Phosphate1Body +
      _aliasHELM +
      ' ' +
      _betweenEntries +
      _idtAliases +
      'base=_phosphate1IDT,ep3=/phosphate1_ep3/,ep5=/phosphate1_ep5/,internal=/phosphate1_internal/' +
      _betweenEntries +
      _endToken;

    const error = await updateMonomersLibrary(page, sdfFile);
    expect(error).not.toBeNull();
    expect(
      await Library(page).isMonomerExist(Phosphate._Phosphate1),
    ).not.toBeTruthy();
  },
);

test.fail(
  'Case 13: Update Library item with compound that contains MOLv3000 file with aliasHELM that contain inpropper characters (quoters and so on)',
  async () => {
    // This issues fails because of the issue: https://github.com/epam/ketcher/issues/8142
    /*
     * Test case: https://github.com/epam/ketcher/issues/8345
     * Description: Update Library item with compound that contains MOLv3000 file with aliasHELM that contain inpropper characters (quoters and so on)
     * Scenario:
     * 1. Go to Macro mode
     * 2. Execute command in console
     * 3. Check that the structure doesn't appears in the Library
     *
     * Version 3.9
     */

    const sdfFile =
      _Phosphate1Body +
      _aliasHELM +
      '\\/' +
      _betweenEntries +
      _idtAliases +
      'base=_phosphate1IDT,ep3=/phosphate1_ep3/,ep5=/phosphate1_ep5/,internal=/phosphate1_internal/' +
      _betweenEntries +
      _endToken;

    const error = await updateMonomersLibrary(page, sdfFile);
    expect(error).not.toBeNull();
    expect(
      await Library(page).isMonomerExist(Phosphate._Phosphate1),
    ).not.toBeTruthy();
  },
);

test.fail(
  'Case 14: Update Library item with compound that contains MOLv3000 file with idtAliases that contain inpropper characters (quoters and so on) for base field',
  async () => {
    // This issues fails because of the issue: https://github.com/epam/ketcher/issues/8201
    /*
     * Test case: https://github.com/epam/ketcher/issues/8345
     * Description: Update Library item with compound that contains MOLv3000 file with idtAliases that contain inpropper characters (quoters and so on) for base field
     * Scenario:
     * 1. Go to Macro mode
     * 2. Execute command in console
     * 3. Check that the structure doesn't appears in the Library
     *
     * Version 3.9
     */

    const sdfFile =
      _Phosphate1Body +
      _idtAliases +
      'base=_phospha/te1IDT' +
      _betweenEntries +
      _endToken;

    const error = await updateMonomersLibrary(page, sdfFile);
    expect(error).not.toBeNull();
    expect(
      await Library(page).isMonomerExist(Phosphate._Phosphate1),
    ).not.toBeTruthy();
  },
);

test.fail(
  'Case 15: Update Library item with compound that contains MOLv3000 file with idtAliases that contain inpropper characters (quoters and so on) for ep5 field',
  async () => {
    // This issues fails because of the issue: https://github.com/epam/ketcher/issues/8203
    /*
     * Test case: https://github.com/epam/ketcher/issues/8345
     * Description: Update Library item with compound that contains MOLv3000 file with idtAliases that contain inpropper characters (quoters and so on) for ep5 field
     * Scenario:
     * 1. Go to Macro mode
     * 2. Execute command in console
     * 3. Check that the structure doesn't appears in the Library
     *
     * Version 3.9
     */

    const sdfFile =
      _Phosphate1Body +
      _idtAliases +
      'base=_phosphate1IDT,ep3=/phosphate1_ep3/,ep5=/phosph\\//ate1_ep5/,internal=/phosphate1_internal/' +
      _betweenEntries +
      _endToken;

    const error = await updateMonomersLibrary(page, sdfFile);
    expect(error).not.toBeNull();
    expect(
      await Library(page).isMonomerExist(Phosphate._Phosphate1),
    ).not.toBeTruthy();
  },
);

test.fail(
  'Case 16: Update Library item with compound that contains MOLv3000 file with idtAliases that contain inpropper characters (quoters and so on) for ep3 field',
  async () => {
    // This issues fails because of the issue: https://github.com/epam/ketcher/issues/8203
    /*
     * Test case: https://github.com/epam/ketcher/issues/8345
     * Description: Update Library item with compound that contains MOLv3000 file with idtAliases that contain inpropper characters (quoters and so on) for ep3 field
     * Scenario:
     * 1. Go to Macro mode
     * 2. Execute command in console
     * 3. Check that the structure doesn't appears in the Library
     *
     * Version 3.9
     */

    const sdfFile =
      _Phosphate1Body +
      _idtAliases +
      'base=_phosphate1IDT,ep3=/phospha\\//te1_ep3/,ep5=/phosphate1_ep5/,internal=/phosphate1_internal/' +
      _betweenEntries +
      _endToken;

    const error = await updateMonomersLibrary(page, sdfFile);
    expect(error).not.toBeNull();
    expect(
      await Library(page).isMonomerExist(Phosphate._Phosphate1),
    ).not.toBeTruthy();
  },
);

test.fail(
  'Case 17: Update Library item with compound that contains MOLv3000 file with idtAliases that contain inpropper characters (quoters and so on) for internal field',
  async () => {
    // This issues fails because of the issue: https://github.com/epam/ketcher/issues/8203
    /*
     * Test case: https://github.com/epam/ketcher/issues/8345
     * Description: Update Library item with compound that contains MOLv3000 file with idtAliases that contain inpropper characters (quoters and so on) for internal field
     * Scenario:
     * 1. Go to Macro mode
     * 2. Execute command in console
     * 3. Check that the structure doesn't appears in the Library
     *
     * Version 3.9
     */

    const sdfFile =
      _Phosphate1Body +
      _idtAliases +
      'base=_phosphate1IDT,ep3=/phosphate1_ep3/,ep5=/phosphate1_ep5/,internal=/phospha\\//te1_internal/' +
      _betweenEntries +
      _endToken;

    const error = await updateMonomersLibrary(page, sdfFile);
    expect(error).not.toBeNull();
    expect(
      await Library(page).isMonomerExist(Phosphate._Phosphate1),
    ).not.toBeTruthy();
  },
);

test('Case 18: Update Library item with compound that contains MOLv3000 file with idtAliases that contain base field and ep5, ep3 and internal fields at the same time', async () => {
  /*
   * Test case: https://github.com/epam/ketcher/issues/8345
   * Description: Update Library item with compound that contains MOLv3000 file with idtAliases that contain base field and ep5, ep3 and internal fields at the same time
   * Scenario:
   * 1. Go to Macro mode
   * 2. Execute command in console
   * 3. Check that the structure appears in the Library
   *
   * Version 3.9
   */

  const sdfFile =
    _Nucleotide1Body +
    _type +
    'monomerTemplate' +
    _betweenEntries +
    _idtAliases +
    'base=_nucleotide1IDT,ep3=/nucleotide1_ep3/,ep5=/nucleotide1_ep5/,internal=/nucleotide1_internal/' +
    _betweenEntries +
    _endToken;

  const error = await updateMonomersLibrary(page, sdfFile);
  expect(error).toBeNull();
  expect(
    await Library(page).isMonomerExist(Nucleotide._Nucleotide1),
  ).toBeTruthy();
  expect(
    await Library(page).getMonomerIDTAliasBase(Nucleotide._Nucleotide1),
  ).toContain('_nucleotide1IDT');
  expect(
    await Library(page).getMonomerIDTAliasEp3(Nucleotide._Nucleotide1),
  ).toContain('/nucleotide1_ep3/');
  expect(
    await Library(page).getMonomerIDTAliasEp5(Nucleotide._Nucleotide1),
  ).toContain('/nucleotide1_ep5/');
  expect(
    await Library(page).getMonomerIDTAliasInternal(Nucleotide._Nucleotide1),
  ).toContain('/nucleotide1_internal/');
});

test.fail(
  'Case 19: Update Library item with compound that contains MOLv3000 file with modificationType field that contain empty value',
  async () => {
    // This issues fails because of the issue: https://github.com/epam/ketcher/issues/8356
    /*
     * Test case: https://github.com/epam/ketcher/issues/8345
     * Description: Update Library item with compound that contains MOLv3000 file with modificationType field that contain empty value
     * Scenario:
     * 1. Go to Macro mode
     * 2. Execute command in console
     * 3. Check that the structure doesn't appears in the Library
     *
     * Version 3.9
     */

    const sdfFile =
      _Peptide1Body +
      _modificationTypes +
      _emptyValue +
      _betweenEntries +
      _endToken;

    const error = await updateMonomersLibrary(page, sdfFile);
    expect(error).not.toBeNull();
    expect(
      await Library(page).isMonomerExist(Peptide._Peptide1),
    ).not.toBeTruthy();
  },
);

test.fail(
  'Case 20: Update Library item with compound that contains MOLv3000 file with modificationType field that contain one space value',
  async () => {
    // This issues fails because of the issue: https://github.com/epam/ketcher/issues/8356
    /*
     * Test case: https://github.com/epam/ketcher/issues/8345
     * Description: Update Library item with compound that contains MOLv3000 file with modificationType field that contain one space value
     * Scenario:
     * 1. Go to Macro mode
     * 2. Execute command in console
     * 3. Check that the structure doesn't appears in the Library
     *
     * Version 3.9
     */

    const sdfFile =
      _Peptide1Body + _modificationTypes + ' ' + _betweenEntries + _endToken;

    const error = await updateMonomersLibrary(page, sdfFile);
    expect(error).not.toBeNull();
    expect(
      await Library(page).isMonomerExist(Peptide._Peptide1),
    ).not.toBeTruthy();
  },
);

test.fail(
  'Case 21: Update Library item with compound that contains MOLv3000 file with modificationType field that contain inpropper characters (quoters and so on)',
  async () => {
    // This issues fails because of the issue: https://github.com/epam/ketcher/issues/8357
    /*
     * Test case: https://github.com/epam/ketcher/issues/8345
     * Description: Update Library item with compound that contains MOLv3000 file with modificationType field that contain inpropper characters (quoters and so on)
     * Scenario:
     * 1. Go to Macro mode
     * 2. Execute command in console
     * 3. Check that the structure doesn't appears in the Library
     *
     * Version 3.9
     */

    const sdfFile =
      _Peptide1Body + _modificationTypes + ' \t ' + _betweenEntries + _endToken;

    const error = await updateMonomersLibrary(page, sdfFile);
    expect(error).not.toBeNull();
    expect(
      await Library(page).isMonomerExist(Peptide._Peptide1),
    ).not.toBeTruthy();
  },
);

test.fail(
  'Case 22: Update Library item with compound that contains MOLv3000 file with groupClass field that has non-RNA value (try DNA)',
  async () => {
    // This issues fails because of the issue: https://github.com/epam/ketcher/issues/8184
    /*
     * Test case: https://github.com/epam/ketcher/issues/8345
     * Description: Update Library item with compound that contains MOLv3000 file with groupClass field that has non-RNA value (try DNA)
     * Scenario:
     * 1. Go to Macro mode
     * 2. Execute command in console
     * 3. Check that the structure doesn't appears in the Library
     *
     * Version 3.9
     */

    const sdfFile =
      _A1Body +
      _type +
      'monomerGroupTemplate' +
      _betweenEntries +
      _groupClass +
      'DNA' +
      _betweenEntries +
      _groupName +
      '_A1' +
      _betweenEntries +
      _endToken;

    const error = await updateMonomersLibrary(page, sdfFile);
    expect(error).not.toBeNull();
    expect(await Library(page).isMonomerExist(Preset._A1)).not.toBeTruthy();
  },
);

test.fail(
  'Case 23: Update Library item with compound that contains MOLv3000 file with monomerGroupTemplate without groupClass field',
  async () => {
    // This issues fails because of the issue: https://github.com/epam/ketcher/issues/8185
    /*
     * Test case: https://github.com/epam/ketcher/issues/8345
     * Description: Update Library item with compound that contains MOLv3000 file with monomerGroupTemplate without groupClass field
     * Scenario:
     * 1. Go to Macro mode
     * 2. Execute command in console
     * 3. Check that the structure doesn't appears in the Library
     *
     * Version 3.9
     */

    const sdfFile =
      _A1Body +
      _type +
      'monomerGroupTemplate' +
      _betweenEntries +
      _groupName +
      '_A1' +
      _betweenEntries +
      _endToken;

    const error = await updateMonomersLibrary(page, sdfFile);
    expect(error).not.toBeNull();
    expect(await Library(page).isMonomerExist(Preset._A1)).not.toBeTruthy();
  },
);

test.fail(
  'Case 24: Update Library item with compound that contains MOLv3000 file with monomerGroupTemplate without groupName field',
  async () => {
    // This issues fails because of the issue: https://github.com/epam/ketcher/issues/8183
    /*
     * Test case: https://github.com/epam/ketcher/issues/8345
     * Description: Update Library item with compound that contains MOLv3000 file with monomerGroupTemplate without groupName field
     * Scenario:
     * 1. Go to Macro mode
     * 2. Execute command in console
     * 3. Check that the structure doesn't appears in the Library
     *
     * Version 3.9
     */

    const sdfFile =
      _A1Body +
      _type +
      'monomerGroupTemplate' +
      _betweenEntries +
      _groupClass +
      'DNA' +
      _betweenEntries +
      _endToken;

    const error = await updateMonomersLibrary(page, sdfFile);
    expect(error).not.toBeNull();
    expect(await Library(page).isMonomerExist(Preset._A1)).not.toBeTruthy();
  },
);

test.fail(
  'Case 25: Update Library item with compound that contains MOLv3000 file with monomerGroupTemplate groupName field that has empty value',
  async () => {
    // This issues fails because of the issue: https://github.com/epam/ketcher/issues/8187
    /*
     * Test case: https://github.com/epam/ketcher/issues/8345
     * Description: Update Library item with compound that contains MOLv3000 file with monomerGroupTemplate groupName field that has empty value
     * Scenario:
     * 1. Go to Macro mode
     * 2. Execute command in console
     * 3. Check that the structure doesn't appears in the Library
     *
     * Version 3.9
     */

    const sdfFile =
      _A1Body +
      _type +
      'monomerGroupTemplate' +
      _betweenEntries +
      _groupClass +
      'DNA' +
      _betweenEntries +
      _groupName +
      _emptyValue +
      _betweenEntries +
      _endToken;

    const error = await updateMonomersLibrary(page, sdfFile);
    expect(error).not.toBeNull();
    expect(await Library(page).isMonomerExist(Preset._A1)).not.toBeTruthy();
  },
);

test.fail(
  'Case 26: Update Library item with compound that contains MOLv3000 file with monomerGroupTemplate groupName field that has one space value',
  async () => {
    // This issues fails because of the issue: https://github.com/epam/ketcher/issues/8182
    /*
     * Test case: https://github.com/epam/ketcher/issues/8345
     * Description: Update Library item with compound that contains MOLv3000 file with monomerGroupTemplate groupName field that has one space value
     * Scenario:
     * 1. Go to Macro mode
     * 2. Execute command in console
     * 3. Check that the structure doesn't appears in the Library
     *
     * Version 3.9
     */

    const sdfFile =
      _A1Body +
      _type +
      'monomerGroupTemplate' +
      _betweenEntries +
      _groupClass +
      'DNA' +
      _betweenEntries +
      _groupName +
      ' ' +
      _betweenEntries +
      _endToken;

    const error = await updateMonomersLibrary(page, sdfFile);
    expect(error).not.toBeNull();
    expect(await Library(page).isMonomerExist(Preset._A1)).not.toBeTruthy();
  },
);

test.fail(
  'Case 27: Update Library item with compound that contains MOLv3000 file with monomerGroupTemplate groupName field that has contain inpropper characters (quoters and so on) value',
  async () => {
    // This issues fails because of the issue: https://github.com/epam/ketcher/issues/8182
    /*
     * Test case: https://github.com/epam/ketcher/issues/8345
     * Description: Update Library item with compound that contains MOLv3000 file with monomerGroupTemplate groupName field that has contain inpropper characters (quoters and so on) value
     * Scenario:
     * 1. Go to Macro mode
     * 2. Execute command in console
     * 3. Check that the structure doesn't appears in the Library
     *
     * Version 3.9
     */

    const sdfFile =
      _A1Body +
      _type +
      'monomerGroupTemplate' +
      _betweenEntries +
      _groupClass +
      'DNA' +
      _betweenEntries +
      _groupName +
      'InproperCharacters\\//' +
      _betweenEntries +
      _endToken;

    const error = await updateMonomersLibrary(page, sdfFile);
    expect(error).not.toBeNull();
    expect(await Library(page).isMonomerExist(Preset._A1)).not.toBeTruthy();
  },
);

test.fail(
  'Case 28: Update Library with SDF that contain few compounds but one of them is invalid (try compound that contains MOLv3000 file with groupClass field that has non-RNA value (try DNA))',
  async () => {
    // This issues fails because of the issue: https://github.com/epam/ketcher/issues/8139
    /*
     * Test case: https://github.com/epam/ketcher/issues/8345
     * Description: Update Library with SDF that contain few compounds but one of them is invalid (try compound that contains MOLv3000 file with groupClass field that has non-RNA value (try DNA))
     * Scenario:
     * 1. Go to Macro mode
     * 2. Execute command in console
     * 3. Check that the structure doesn't appears in the Library
     *
     * Version 3.9
     */

    const sdfFile =
      _A1Body +
      _type +
      'monomerGroupTemplate' +
      _betweenEntries +
      _groupClass +
      'RNA' +
      _betweenEntries +
      _groupName +
      '_A1' +
      _betweenEntries +
      _A1Body +
      _type +
      'monomerGroupTemplate' +
      _betweenEntries +
      _groupClass +
      'DNA' +
      _betweenEntries +
      _groupName +
      '_A2' +
      _betweenEntries +
      _A1Body +
      _type +
      'monomerGroupTemplate' +
      _betweenEntries +
      _groupClass +
      'RNA' +
      _betweenEntries +
      _groupName +
      '_A3' +
      _betweenEntries +
      _endToken;

    const error = await updateMonomersLibrary(page, sdfFile);
    expect(error).not.toBeNull();
    expect(await Library(page).isMonomerExist(Preset._A1)).toBeTruthy();
    expect(await Library(page).isMonomerExist(Preset._A2)).not.toBeTruthy();
    expect(await Library(page).isMonomerExist(Preset._A3)).toBeTruthy();
  },
);
